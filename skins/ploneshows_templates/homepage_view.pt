<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
<body>

<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main"
           tal:define="kssClassesView context/@@kss_field_decorator_view;
                       getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                       templateId template/getId;
                       text here/getText;
                       portal_url context/@@plone_portal_state/portal_url;">

<div id="carousel-wrapper"
  tal:define="objects context/components/homepage-slideshow/getFolderContents|nothing;">

  <script src="jquery.jcarousel.min.js" type="text/javascript" 
    tal:attributes="src string:${portal_url}/++theme++plonetheme.popejoy2016/jquery.jcarousel.min.js"></script>
  
  <div id="carousel">
    <ul>
      <tal:images tal:repeat="object objects">
        <li>
          <a href="#" tal:attributes="href string:${portal_url}${object/Description};">
            <img src="someimage.jpg" class="full" alt=""
              tal:attributes="src object/getURL|object/absolute_url;
                              alt object/Title|nothing;" />
            <div class="title">
              <span class="buttonText">Learn More &raquo;</span>
              <span class="titleText" tal:content="object/Title">[Title]</span>
            </div>
          </a>
        </li>
      </tal:images>
    </ul>
  </div>
  
</div>

<script type="text/javascript">
// first we move the slideshow into its appropriate location
jQuery("#carousel").appendTo("#slideshow-popejoy-target");
// Initializing carousel
var carousel = jQuery('#carousel').jcarousel({
    // Configuration goes here
    wrap: 'circular',
  })
  .jcarouselAutoscroll({
    interval: 3500,
    target: '+=1',
    autostart: true
  });
</script>

        <div tal:replace="structure provider:plone.abovecontenttitle" />

        <h1 class="documentFirstHeading hiddenStructure"> 
            <metal:field use-macro="python:here.widget('title', mode='view')">
            Title
            </metal:field>
        </h1>

        <div tal:replace="structure provider:plone.belowcontenttitle" />

        <p class="documentDescription hiddenStructure">
            <metal:field use-macro="python:here.widget('description', mode='view')">
            Description
            </metal:field>
        </p>

        <div tal:replace="structure provider:plone.abovecontentbody" />

        <p tal:condition="python: not text and is_editable"
           i18n:translate="no_body_text"
           class="discreet">
            This item does not have any body text, click the edit tab to change it.
        </p>

<div id="homepage-body-text">
        <metal:field use-macro="python:here.widget('text', mode='view')">
        Body text
        </metal:field>
</div>

<div id="homepage-this-season-wrapper">
<div id="homepage-this-season">

<!-- <ul id="season-links">
<li><a href="#" 
	tal:define="currentSeason context/getCurrentSeason|nothing;
		    currentSeasonUrl currentSeason/getURL|nothing;" 
	tal:attributes="href currentSeasonUrl">View full season</a>
</li>
<li><a href="/tickets/season-tickets" tal:attributes="href string:${portal_url}/tickets/season-tickets">Buy season tickets</a>
</li>
</ul> -->

<div id="performance-listing-homepage"
	tal:define="performances context/getHomepageUpcomingShows"
	tal:condition="performances">

<div id="view-full-season">
  <a href="#"
    tal:attributes="href python: context.getCurrentSeason().getURL();">
    View Full Season &raquo;
  </a>
</div>
<h2 id="upcoming-shows-header">Upcoming Shows</h2>

<div id="homepage-performances">
  <div class="performance" tal:repeat="performance performances">
    <a href="#" 
      tal:attributes="href performance/getURL|performance/absolute_url;">
      <img 
        tal:condition="performance/aq_parent/getImagePopejoyTallThumbnail"
        tal:define="scales performance/aq_parent/@@images;"
        tal:replace="structure python: scales.tag('imagePopejoyTallThumbnail', width=193, height=260, direction='down')"/>
    </a>

    <div class="performanceTickets"><a href="#" tal:attributes="href performance/getURL|performance/absolute_url;"></a></div>
    <div class="performanceText">
      <div class="tileFooter">
        <a href="#"
          tal:attributes="href performance/getURL|performance/absolute_url;">
          Tickets and Info &raquo;
        </a>
      </div>

      <h3>
      	<a href="#" tal:attributes="href performance/getURL|performance/absolute_url;"
      		tal:content="performance/Title">[Performance Title]</a>
      </h3>

      <tal:startDate tal:define="startDay  python:performance.start().Day();
                                 startDate python:performance.start().aCommon();">
        <div class="performanceDate" tal:content="string: ${startDay}, ${startDate}">[Performance Date]</div>
      </tal:startDate>

      <!-- <div class="performanceDescription" tal:content="python: performance.aq_parent.Description()">[Performance Description]</div> -->
    </div>
    <div class="visualClear"><!-- --></div>
  </div>
</div>

</div>
</div>

        <div metal:use-macro="here/document_relateditems/macros/relatedItems">
            show related items if they exist
        </div>

        <div tal:replace="structure provider:plone.belowcontentbody" />

    </tal:main-macro>
</metal:main>

</body>
</html>
